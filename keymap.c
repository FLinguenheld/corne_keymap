/*
Copyright 2019 @foostan
Copyright 2020 Drashna Jaelre <@drashna>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of

GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

#include QMK_KEYBOARD_H
#include <stdio.h>
#include <keymap_bepo.h>
#include "features/french.h"


#include "features/lt_semicolon.c"


        // SEND_STRING("aurnisetaurie");
        // send_unicode_string("(ノಠ痊ಠ)ノ彡┻━┻");






#include "features/tap_dance.c"



// Tap Dance definitions
qk_tap_dance_action_t tap_dance_actions[] = {
    [TD_BSPC_DEL] = ACTION_TAP_DANCE_TAP_HOLD(KC_BSPC, KC_DEL),
    [TD_ALT_TREMA] = ACTION_TAP_DANCE_TAP_HOLD(BP_DIAE, KC_LEFT_ALT),
    [TD_EXCLA_QUEST] = ACTION_TAP_DANCE_TAP_HOLD(BP_EXLM, BP_QUES),
    [TD_QUOTE_3DOTS] = ACTION_TAP_DANCE_TAP_HOLD(BP_QUOT, BP_ELLP),

    [TD_PARENT] = ACTION_TAP_DANCE_TAP_HOLD(BP_LPRN, BP_RPRN),
    [TD_BRACK] = ACTION_TAP_DANCE_TAP_HOLD(BP_LBRC, BP_RBRC),
    [TD_CURLY_B] = ACTION_TAP_DANCE_TAP_HOLD(BP_LCBR, BP_RCBR),
    [TD_SLASHS] = ACTION_TAP_DANCE_TAP_HOLD(BP_BSLS, BP_SLSH),

    [TD_CURRENCY] = ACTION_TAP_DANCE_TAP_HOLD(BP_DLR, BP_EURO),
    [TD_PERCENT] = ACTION_TAP_DANCE_TAP_HOLD(BP_PERC, BP_PERM),



    [TD_ESC_CAPS] = ACTION_TAP_DANCE_TAP_HOLD(BP_CCED, BP_EACU),
    [TD_FLO] = ACTION_TAP_DANCE_DOUBLE(BP_EURO, BP_AE),


    // Specific tap dances to replace LT(layer, kc)
    [TDS_LT3_COLON] = ACTION_TAP_DANCE_FN_ADVANCED(NULL, lt3_colon_finished, lt3_colon_reset),
    [TDS_LT4_SCOLON] = ACTION_TAP_DANCE_FN_ADVANCED(NULL, lt4_scolon_finished, lt4_scolon_reset)
};


// https://github.com/qmk/qmk_firmware/blob/master/quantum/keymap_extras/keymap_bepo.h



  /* [1] = LAYOUT_split_3x6_3(

  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
                                                                  XXXXXXX     ,       XXXXXXX     ,         XXXXXXX       ,          XXXXXXX          ,     XXXXXXX       ,      XXXXXXX
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
  ), */



const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
  [0] = LAYOUT_split_3x6_3(

  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
       KC_TAB               ,     BP_Z       ,    BP_EACU     ,     BP_P       ,     BP_O       ,        BP_ECIR        ,                BP_AGRV        ,      BP_V      ,      BP_D      ,      BP_L      ,      BP_J      ,     TD(TD_BSPC_DEL)   ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
      GUI_T(KC_ESC)         ,     BP_A       ,     BP_U       ,     BP_I       ,     BP_E       ,   TD(TD_EXCLA_QUEST)  ,                 BP_C          ,      BP_T      ,      BP_S      ,      BP_R      ,      BP_N      ,     BP_M              ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
      TD(TD_ALT_TREMA)      ,     BP_B       ,     BP_Y       ,     BP_X       ,     BP_W       ,   TD(TD_QUOTE_3DOTS)  ,                 BP_K          ,      BP_Q      ,      BP_G      ,      BP_H      ,      BP_F      , MT(MOD_RSFT, BP_DCIR) ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
                                                            TD(TDS_LT4_SCOLON),   LT(1, BP_COMM)  ,    LCTL_T(KC_SPC)     ,        KC_ENT             ,   LT(2, BP_DOT)   , TD(TDS_LT3_COLON)
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
  ),

  [1] = LAYOUT_split_3x6_3(

  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            BP_UNDS         ,     XXXXXXX    ,     BP_GRV     ,     BP_QUOT    ,    BP_DQUO     ,        XXXXXXX        ,               XXXXXXX         ,    BP_HASH     ,TD(TD_CURRENCY) ,      BP_AT     ,     XXXXXXX    ,        _______        ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    , TD(TD_CURLY_B) ,  TD(TD_BRACK)  ,  TD(TD_PARENT) ,        XXXXXXX        ,               XXXXXXX         ,    BP_AMPR     ,     BP_PIPE    ,     BP_TILD    ,     BP_ASTR    ,        XXXXXXX        ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     BP_LABK    ,    BP_RABK     ,  TD(TD_SLASHS) ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,     XXXXXXX    ,     XXXXXXX    ,     BP_CIRC    ,        _______        ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
                                                               LT(4, BP_SCLN) ,   LT(1, BP_COMM)  ,    LCTL_T(KC_SPC)     ,        KC_ENT             ,   LT(2, BP_DOT)   ,   LT(5, BP_COLN)
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
  ),


  [2] = LAYOUT_split_3x6_3(

  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,      BP_7      ,      BP_8      ,      BP_9      ,     BP_PLUS    ,       BP_MINS         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,                BP_EQL         ,      BP_4      ,      BP_5      ,      BP_6      ,     BP_ASTR    ,       BP_SLSH         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,                BP_DOT         ,      BP_1      ,      BP_2      ,      BP_3      ,     BP_CIRC    ,    TD(TD_PERCENT)     ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
                                                                  XXXXXXX     ,       XXXXXXX     ,         XXXXXXX       ,          XXXXXXX          ,     XXXXXXX       ,       BP_0
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
  ),

  [3] = LAYOUT_split_3x6_3(

  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,    KC_HOME     ,  KC_PAGE_DOWN  ,   KC_PAGE_UP   ,     KC_END     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,    KC_LEFT     ,    KC_DOWN     ,     KC_UP      ,    KC_RIGHT    ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,     XXXXXXX    ,     XXXXXXX    ,     XXXXXXX    ,    XXXXXXX     ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,   CTL_T(BP_D)  ,   CTL_T(BP_U)  ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
                                                                  XXXXXXX     ,       XXXXXXX     ,         XXXXXXX       ,          XXXXXXX          ,     XXXXXXX       ,      XXXXXXX
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
  ),

  [4] = LAYOUT_split_3x6_3(

  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,  KC_MS_WH_LEFT ,   KC_MS_WH_UP  ,  KC_MS_WH_DOWN , KC_MS_WH_RIGHT ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,   KC_MS_LEFT   ,    KC_MS_UP    ,   KC_MS_DOWN   ,   KC_MS_RIGHT  ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
            _______         ,   KC_MS_BTN1   ,     XXXXXXX    ,   KC_MS_BTN3   ,   KC_MS_BTN2   ,        XXXXXXX        ,               XXXXXXX         ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,    XXXXXXX     ,       _______         ,
  //|-----------------------+----------------+----------------+----------------+----------------+-----------------------|       |-----------------------+----------------+----------------+----------------+----------------+-----------------------|
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
                                                                  XXXXXXX     ,       XXXXXXX     ,         XXXXXXX       ,          XXXXXXX          ,     XXXXXXX       ,      XXXXXXX
  //                                                      |-------------------+-------------------+-----------------------|   |-----------------------+-------------------+-------------------|
  ),
};




// Auto shift
bool get_custom_auto_shifted_key(uint16_t keycode, keyrecord_t *record) {
    switch(keycode) {
        case KC_TAB:
            return true;
        case BP_AT:
            return false;
        default:
            return false;
    }
}





